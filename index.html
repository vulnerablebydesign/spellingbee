<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#f59e0b">
  <title>Spelling Bee Practice</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      min-height: 100vh;
      min-height: -webkit-fill-available;
      overflow: hidden;
    }

    .screen {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      min-height: -webkit-fill-available;
      padding: 20px;
    }

    .screen.active {
      display: flex;
    }

    /* Mode Selection Screen */
    .mode-screen h1 {
      font-size: 2.5rem;
      color: #92400e;
      margin-bottom: 10px;
      text-align: center;
    }

    .mode-screen .bee-icon {
      font-size: 4rem;
      margin-bottom: 20px;
    }

    .mode-screen .subtitle {
      color: #a16207;
      margin-bottom: 40px;
      font-size: 1.1rem;
    }

    .mode-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      max-width: 400px;
      width: 100%;
    }

    .mode-btn {
      background: white;
      border: 3px solid #f59e0b;
      border-radius: 20px;
      padding: 25px 20px;
      font-size: 1.3rem;
      font-weight: 600;
      color: #92400e;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .mode-btn:hover, .mode-btn:active {
      background: #f59e0b;
      color: white;
      transform: scale(1.02);
    }

    .mode-btn .count {
      display: block;
      font-size: 0.9rem;
      font-weight: 400;
      color: #a16207;
      margin-top: 5px;
    }

    .mode-btn:hover .count, .mode-btn:active .count {
      color: #fef3c7;
    }

    .mode-btn.all-btn {
      grid-column: span 2;
      background: #f59e0b;
      color: white;
    }

    .mode-btn.all-btn .count {
      color: #fef3c7;
    }

    .mode-btn.all-btn:hover, .mode-btn.all-btn:active {
      background: #d97706;
    }

    /* Game Screen */
    .game-screen {
      position: relative;
      justify-content: flex-start;
      padding-top: 60px;
    }

    .header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 15px 20px;
    }

    .exit-btn {
      background: rgba(255, 255, 255, 0.9);
      border: none;
      border-radius: 50%;
      width: 44px;
      height: 44px;
      font-size: 1.5rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .stats {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 15px;
      padding: 12px 18px;
      text-align: right;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .stats div {
      font-size: 0.95rem;
      margin: 3px 0;
      color: #78350f;
    }

    .stats .correct { color: #15803d; }
    .stats .incorrect { color: #dc2626; }

    /* Card */
    .card-container {
      perspective: 1000px;
      width: 100%;
      max-width: 350px;
      height: 220px;
      margin: 40px 0;
    }

    .card {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s ease;
    }

    .card.flipped {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }

    .card-front {
      background: linear-gradient(145deg, #ffffff, #f3f4f6);
      border: 3px solid #e5e7eb;
    }

    .card-front::before {
      content: "?";
      font-size: 5rem;
      color: #d1d5db;
    }

    .card-back {
      background: linear-gradient(145deg, #ffffff, #fef3c7);
      border: 3px solid #f59e0b;
      transform: rotateY(180deg);
    }

    .card-back .word {
      font-size: 2rem;
      font-weight: 600;
      color: #78350f;
      text-align: center;
      padding: 20px;
    }

    /* Buttons */
    .action-btn {
      background: #f59e0b;
      color: white;
      border: none;
      border-radius: 15px;
      padding: 18px 40px;
      font-size: 1.3rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: all 0.2s ease;
    }

    .action-btn:hover, .action-btn:active {
      background: #d97706;
      transform: scale(1.02);
    }

    .answer-buttons {
      display: flex;
      gap: 20px;
      margin-top: 20px;
    }

    .answer-btn {
      padding: 18px 35px;
      font-size: 1.2rem;
      font-weight: 600;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .correct-btn {
      background: #22c55e;
      color: white;
    }

    .correct-btn:hover, .correct-btn:active {
      background: #16a34a;
    }

    .incorrect-btn {
      background: #ef4444;
      color: white;
    }

    .incorrect-btn:hover, .incorrect-btn:active {
      background: #dc2626;
    }

    .hidden {
      display: none !important;
    }

    /* Complete Screen */
    .complete-screen {
      text-align: center;
    }

    .complete-screen h1 {
      font-size: 2.5rem;
      color: #15803d;
      margin-bottom: 20px;
    }

    .complete-screen .trophy {
      font-size: 5rem;
      margin-bottom: 20px;
    }

    .final-stats {
      background: white;
      border-radius: 20px;
      padding: 25px 40px;
      margin: 20px 0 30px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .final-stats div {
      font-size: 1.2rem;
      margin: 8px 0;
      color: #78350f;
    }

    .final-stats .accuracy {
      font-size: 1.5rem;
      font-weight: 600;
      margin-top: 15px;
      color: #92400e;
    }

    /* Resume Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
    }

    .modal {
      background: white;
      border-radius: 25px;
      padding: 30px;
      max-width: 350px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    }

    .modal h2 {
      color: #92400e;
      margin-bottom: 15px;
    }

    .modal p {
      color: #78350f;
      margin-bottom: 25px;
    }

    .modal-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .modal-btn {
      padding: 12px 25px;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.2s ease;
    }

    .modal-btn.primary {
      background: #f59e0b;
      color: white;
    }

    .modal-btn.secondary {
      background: #e5e7eb;
      color: #78350f;
    }
  </style>
</head>
<body>
  <!-- Mode Selection Screen -->
  <div id="mode-screen" class="screen mode-screen active">
    <div class="bee-icon">üêù</div>
    <h1>Spelling Bee</h1>
    <p class="subtitle">2025-2026 Study List</p>
    <div class="mode-buttons">
      <button class="mode-btn all-btn" data-mode="all">
        All Words
        <span class="count" id="all-count">450 words</span>
      </button>
      <button class="mode-btn" data-mode="one">
        One Bee
        <span class="count" id="one-count">150 words</span>
      </button>
      <button class="mode-btn" data-mode="two">
        Two Bee
        <span class="count" id="two-count">100 words</span>
      </button>
      <button class="mode-btn" data-mode="three">
        Three Bee
        <span class="count" id="three-count">200 words</span>
      </button>
    </div>
  </div>

  <!-- Game Screen -->
  <div id="game-screen" class="screen game-screen">
    <div class="header">
      <button class="exit-btn" id="exit-btn">‚úï</button>
      <div class="stats">
        <div class="correct">‚úì Correct: <span id="correct-count">0</span></div>
        <div class="incorrect">‚úó Incorrect: <span id="incorrect-count">0</span></div>
        <div>üìù Left: <span id="remaining-count">0</span></div>
      </div>
    </div>

    <div class="card-container">
      <div class="card" id="card">
        <div class="card-face card-front"></div>
        <div class="card-face card-back">
          <div class="word" id="word-display"></div>
        </div>
      </div>
    </div>

    <button class="action-btn" id="next-btn">
      <span>üîä</span> Next Word
    </button>

    <button class="action-btn hidden" id="show-btn">
      <span>üëÅÔ∏è</span> Show Word
    </button>

    <div class="answer-buttons hidden" id="answer-buttons">
      <button class="answer-btn correct-btn" id="correct-btn">
        <span>‚úì</span> Correct
      </button>
      <button class="answer-btn incorrect-btn" id="incorrect-btn">
        <span>‚úó</span> Incorrect
      </button>
    </div>
  </div>

  <!-- Complete Screen -->
  <div id="complete-screen" class="screen complete-screen">
    <div class="trophy">üèÜ</div>
    <h1>Complete!</h1>
    <div class="final-stats">
      <div>‚úì Correct: <span id="final-correct">0</span></div>
      <div>‚úó Incorrect: <span id="final-incorrect">0</span></div>
      <div class="accuracy">Accuracy: <span id="final-accuracy">0</span>%</div>
    </div>
    <button class="action-btn" id="play-again-btn">
      <span>üîÑ</span> Play Again
    </button>
  </div>

  <!-- Resume Modal -->
  <div class="modal-overlay hidden" id="resume-modal">
    <div class="modal">
      <h2>Resume Game?</h2>
      <p id="resume-info">You have a saved game in progress.</p>
      <div class="modal-buttons">
        <button class="modal-btn secondary" id="new-game-btn">New Game</button>
        <button class="modal-btn primary" id="resume-btn">Resume</button>
      </div>
    </div>
  </div>

  <script src="words.js"></script>
  <script>
    // State
    let state = {
      mode: null,
      remainingWords: [],
      currentWord: null,
      correct: 0,
      incorrect: 0,
      phase: 'idle' // idle, spoken, revealed
    };

    // Audio unlock for iOS
    let audioUnlocked = false;
    document.addEventListener('click', () => {
      if (!audioUnlocked) {
        const utterance = new SpeechSynthesisUtterance('');
        speechSynthesis.speak(utterance);
        audioUnlocked = true;
      }
    }, { once: true });

    // Elements
    const modeScreen = document.getElementById('mode-screen');
    const gameScreen = document.getElementById('game-screen');
    const completeScreen = document.getElementById('complete-screen');
    const card = document.getElementById('card');
    const wordDisplay = document.getElementById('word-display');
    const nextBtn = document.getElementById('next-btn');
    const showBtn = document.getElementById('show-btn');
    const answerButtons = document.getElementById('answer-buttons');
    const correctBtn = document.getElementById('correct-btn');
    const incorrectBtn = document.getElementById('incorrect-btn');
    const exitBtn = document.getElementById('exit-btn');
    const resumeModal = document.getElementById('resume-modal');
    const resumeInfo = document.getElementById('resume-info');
    const resumeBtn = document.getElementById('resume-btn');
    const newGameBtn = document.getElementById('new-game-btn');
    const playAgainBtn = document.getElementById('play-again-btn');

    // Update word counts on load
    document.getElementById('one-count').textContent = `${WORD_LISTS.one.length} words`;
    document.getElementById('two-count').textContent = `${WORD_LISTS.two.length} words`;
    document.getElementById('three-count').textContent = `${WORD_LISTS.three.length} words`;
    document.getElementById('all-count').textContent = `${WORD_LISTS.all.length} words`;

    // Mode selection
    document.querySelectorAll('.mode-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const mode = btn.dataset.mode;
        const saved = loadState(mode);

        if (saved && saved.remainingWords.length > 0) {
          state.mode = mode;
          resumeInfo.textContent = `${saved.correct + saved.incorrect} words completed, ${saved.remainingWords.length} remaining.`;
          resumeModal.classList.remove('hidden');
        } else {
          startGame(mode, false);
        }
      });
    });

    // Resume modal
    resumeBtn.addEventListener('click', () => {
      resumeModal.classList.add('hidden');
      startGame(state.mode, true);
    });

    newGameBtn.addEventListener('click', () => {
      resumeModal.classList.add('hidden');
      startGame(state.mode, false);
    });

    // Start game
    function startGame(mode, resume) {
      state.mode = mode;

      if (resume) {
        const saved = loadState(mode);
        state.remainingWords = saved.remainingWords;
        state.correct = saved.correct;
        state.incorrect = saved.incorrect;
      } else {
        state.remainingWords = [...WORD_LISTS[mode]];
        shuffleArray(state.remainingWords);
        state.correct = 0;
        state.incorrect = 0;
      }

      state.currentWord = null;
      state.phase = 'idle';

      updateStats();
      showScreen('game');
      resetCard();
    }

    // Screens
    function showScreen(screen) {
      modeScreen.classList.remove('active');
      gameScreen.classList.remove('active');
      completeScreen.classList.remove('active');

      if (screen === 'mode') modeScreen.classList.add('active');
      else if (screen === 'game') gameScreen.classList.add('active');
      else if (screen === 'complete') completeScreen.classList.add('active');
    }

    // Update stats display
    function updateStats() {
      document.getElementById('correct-count').textContent = state.correct;
      document.getElementById('incorrect-count').textContent = state.incorrect;
      document.getElementById('remaining-count').textContent = state.remainingWords.length;
    }

    // Reset card state
    function resetCard() {
      card.classList.remove('flipped');
      wordDisplay.textContent = '';
      nextBtn.classList.remove('hidden');
      showBtn.classList.add('hidden');
      answerButtons.classList.add('hidden');
    }

    // Next word
    nextBtn.addEventListener('click', () => {
      if (state.remainingWords.length === 0) {
        showComplete();
        return;
      }

      const index = Math.floor(Math.random() * state.remainingWords.length);
      state.currentWord = state.remainingWords[index];
      state.phase = 'spoken';

      speakWord(state.currentWord);

      nextBtn.classList.add('hidden');
      showBtn.classList.remove('hidden');
    });

    // Show word
    showBtn.addEventListener('click', () => {
      wordDisplay.textContent = state.currentWord;
      card.classList.add('flipped');
      state.phase = 'revealed';

      showBtn.classList.add('hidden');
      answerButtons.classList.remove('hidden');
    });

    // Correct answer
    correctBtn.addEventListener('click', () => {
      state.correct++;
      // Remove word from remaining
      const index = state.remainingWords.indexOf(state.currentWord);
      if (index > -1) {
        state.remainingWords.splice(index, 1);
      }
      saveState();
      nextRound();
    });

    // Incorrect answer
    incorrectBtn.addEventListener('click', () => {
      state.incorrect++;
      // Word stays in remaining words
      saveState();
      nextRound();
    });

    // Next round
    function nextRound() {
      updateStats();

      if (state.remainingWords.length === 0) {
        showComplete();
        return;
      }

      state.phase = 'idle';
      resetCard();
    }

    // Show complete screen
    function showComplete() {
      const total = state.correct + state.incorrect;
      const accuracy = total > 0 ? Math.round((state.correct / total) * 100) : 0;

      document.getElementById('final-correct').textContent = state.correct;
      document.getElementById('final-incorrect').textContent = state.incorrect;
      document.getElementById('final-accuracy').textContent = accuracy;

      clearState(state.mode);
      showScreen('complete');
    }

    // Exit game
    exitBtn.addEventListener('click', () => {
      showScreen('mode');
    });

    // Play again
    playAgainBtn.addEventListener('click', () => {
      showScreen('mode');
    });

    // Speak word
    function speakWord(word) {
      speechSynthesis.cancel();
      const utterance = new SpeechSynthesisUtterance(word);
      utterance.rate = 0.8;
      utterance.pitch = 1;

      // Try to get a good voice
      const voices = speechSynthesis.getVoices();
      const englishVoice = voices.find(v => v.lang.startsWith('en') && v.localService);
      if (englishVoice) {
        utterance.voice = englishVoice;
      }

      speechSynthesis.speak(utterance);
    }

    // Shuffle array
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // LocalStorage
    function saveState() {
      const key = `spellingbee_${state.mode}`;
      localStorage.setItem(key, JSON.stringify({
        remainingWords: state.remainingWords,
        correct: state.correct,
        incorrect: state.incorrect
      }));
    }

    function loadState(mode) {
      const key = `spellingbee_${mode}`;
      const data = localStorage.getItem(key);
      return data ? JSON.parse(data) : null;
    }

    function clearState(mode) {
      const key = `spellingbee_${mode}`;
      localStorage.removeItem(key);
    }

    // Load voices
    speechSynthesis.onvoiceschanged = () => {
      speechSynthesis.getVoices();
    };

    // Register service worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
  </script>
</body>
</html>
